import{l as T,ay as E,j as o,r as t,k as S,az as R,a7 as b}from"./components-DuRBtGp8-CgeLxIBe.js";T.info("Element Call popout dev");const p=E.createRoot(document.getElementById("root"));let r=null;window.isSecureContext?navigator.mediaDevices||(r=new Error("Your browser does not support WebRTC.")):r=new Error(`This app cannot run in an insecure context. To fix this, access the app via a local loopback address, or serve it over HTTPS.
https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts`);if(r!==null)throw p.render(r.message),r;const j=b,l=new URLSearchParams(document.location.search),c=l.get("mediaType"),u=l.get("participantId");l.get("displayName");const y=()=>{const[s,f]=t.useState(),[m,w]=t.useState(),[h,g]=t.useState(window.innerHeight),[a,k]=t.useState(),v=useRef(null);t.useEffect(()=>{const e=new BroadcastChannel("popout-token-request");return v.current=e,e.onmessage=n=>{if(n.data.type!=="popout_token")return;const i=n.data.sfuConfig;a.connect(i.url,i.jwt).then(k)},e.postMessage({type:"popout_token_request"}),()=>{e.close()}},[localConnection]),t.useEffect(()=>{let e=0;return s===void 0&&(e=window.setTimeout(()=>{const n=a?.remoteParticipants.get(u);w(n);const i=n?.getTrackPublication(c);f(i)},1e3)),()=>{e!=0&&window.clearTimeout(e)}},[c,u,a,s]);const d=t.useCallback(()=>{g(window.innerHeight)},[]);if(t.useEffect(()=>{const e=S(d);return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[d]),s===void 0)return o.jsx("p",{children:" loading.... "});const x={participant:m,publication:s,source:c};return o.jsxs(R,{room:a,token:accessToken,serverUrl:livekitUrl,video:!1,audio:!1,children:[o.jsx(j,{muted:!0,autoPlay:!0,trackRef:x,height:h}),";"]})};p.render(o.jsx(t.StrictMode,{children:o.jsx(t.Suspense,{fallback:o.jsx("p",{children:"Connecting..."}),children:o.jsx(y,{})})}));
//# sourceMappingURL=popout-uLwdHaFl.js.map
