import{l as f,ay as j,j as o,r as t,u as y,k as b,az as C,a7 as z}from"./components-DuRBtGp8-CgeLxIBe.js";f.info("Element Call popout dev");const m=j.createRoot(document.getElementById("root"));let s=null;window.isSecureContext?navigator.mediaDevices||(s=new Error("Your browser does not support WebRTC.")):s=new Error(`This app cannot run in an insecure context. To fix this, access the app via a local loopback address, or serve it over HTTPS.
https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts`);if(s!==null)throw m.render(s.message),s;const H=z,d=new URLSearchParams(document.location.search),c=d.get("mediaType"),w=d.get("participantId");d.get("displayName");const P=()=>{const[a,h]=t.useState(),[g,x]=t.useState(),[k,v]=t.useState(window.innerHeight),[T,E]=t.useState();if(!window.opener)return o.jsx("p",{children:" No parent window; this only works when opened from an existing call! "});const R=t.useRef(null);t.useEffect(()=>{const e=new window.opener.BroadcastChannel("popout-token-request");return R.current=e,e.onmessage=n=>{if(f.info("event received",n),n.data.type!=="popout_token")return;const r=n.data.sfuConfig;let p=new y;p.connect(r.url,r.jwt).then(()=>E([p,r]))},e.postMessage({type:"popout_token_request"}),()=>{e.close()}},[]),t.useEffect(()=>{let e=0;return a===void 0&&(e=window.setTimeout(()=>{const n=i?.remoteParticipants.get(w);x(n);const r=n?.getTrackPublication(c);h(r)},1e3)),()=>{e!=0&&window.clearTimeout(e)}},[c,w,i,a]);const l=t.useCallback(()=>{v(window.innerHeight)},[]);if(t.useEffect(()=>{const e=b(l);return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[l]),!i||!a)return o.jsx("p",{children:" loading.... "});const S={participant:g,publication:a,source:c},[i,u]=T;return o.jsxs(C,{room:i,token:u.jwt,serverUrl:u.url,video:!1,audio:!1,children:[o.jsx(H,{muted:!0,autoPlay:!0,trackRef:S,height:k}),";"]})};m.render(o.jsx(t.StrictMode,{children:o.jsx(t.Suspense,{fallback:o.jsx("p",{children:"Connecting..."}),children:o.jsx(P,{})})}));
//# sourceMappingURL=popout-DgAtPKNa.js.map
