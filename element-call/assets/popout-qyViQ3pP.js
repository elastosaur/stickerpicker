import{l as p,ay as E,j as o,r as t,k as S,az as R,a7 as b}from"./components-DuRBtGp8-CgeLxIBe.js";p.info("Element Call popout dev");const f=E.createRoot(document.getElementById("root"));let r=null;window.isSecureContext?navigator.mediaDevices||(r=new Error("Your browser does not support WebRTC.")):r=new Error(`This app cannot run in an insecure context. To fix this, access the app via a local loopback address, or serve it over HTTPS.
https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts`);if(r!==null)throw f.render(r.message),r;const j=b,d=new URLSearchParams(document.location.search),c=d.get("mediaType"),u=d.get("participantId");d.get("displayName");const y=()=>{const[s,m]=t.useState(),[w,h]=t.useState(),[g,k]=t.useState(window.innerHeight),[a,v]=t.useState(),x=t.useRef(null);t.useEffect(()=>{const e=new BroadcastChannel("popout-token-request");return x.current=e,e.onmessage=n=>{if(p.info("event received",n),n.data.type!=="popout_token")return;const i=n.data.sfuConfig;a.connect(i.url,i.jwt).then(v)},e.postMessage({type:"popout_token_request"}),()=>{e.close()}},[]),t.useEffect(()=>{let e=0;return s===void 0&&(e=window.setTimeout(()=>{const n=a?.remoteParticipants.get(u);h(n);const i=n?.getTrackPublication(c);m(i)},1e3)),()=>{e!=0&&window.clearTimeout(e)}},[c,u,a,s]);const l=t.useCallback(()=>{k(window.innerHeight)},[]);if(t.useEffect(()=>{const e=S(l);return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[l]),s===void 0)return o.jsx("p",{children:" loading.... "});const T={participant:w,publication:s,source:c};return o.jsxs(R,{room:a,token:accessToken,serverUrl:livekitUrl,video:!1,audio:!1,children:[o.jsx(j,{muted:!0,autoPlay:!0,trackRef:T,height:g}),";"]})};f.render(o.jsx(t.StrictMode,{children:o.jsx(t.Suspense,{fallback:o.jsx("p",{children:"Connecting..."}),children:o.jsx(y,{})})}));
//# sourceMappingURL=popout-qyViQ3pP.js.map
