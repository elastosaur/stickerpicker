import{l as m,ay as j,j as o,r as t,u as y,k as b,az as C,a7 as z}from"./components-DuRBtGp8-CgeLxIBe.js";m.info("Element Call popout dev");const h=j.createRoot(document.getElementById("root"));let s=null;window.isSecureContext?navigator.mediaDevices||(s=new Error("Your browser does not support WebRTC.")):s=new Error(`This app cannot run in an insecure context. To fix this, access the app via a local loopback address, or serve it over HTTPS.
https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts`);if(s!==null)throw h.render(s.message),s;const H=z,d=new URLSearchParams(document.location.search),c=d.get("mediaType"),f=d.get("participantId");d.get("displayName");const P=()=>{const[a,g]=t.useState(),[x,k]=t.useState(),[v,T]=t.useState(window.innerHeight),[l,E]=t.useState();if(!window.opener)return o.jsx("p",{children:" No parent window; this only works when opened from an existing call! "});const R=t.useRef(null);t.useEffect(()=>{const e=new window.opener.BroadcastChannel("popout-token-request");return R.current=e,e.onmessage=n=>{if(m.info("event received",n),n.data.type!=="popout_token")return;const r=n.data.sfuConfig;let w=new y;w.connect(r.url,r.jwt).then(()=>E([w,r]))},e.postMessage({type:"popout_token_request"}),()=>{e.close()}},[]),t.useEffect(()=>{let e=0;return a===void 0&&(e=window.setTimeout(()=>{const n=i?.remoteParticipants.get(f);k(n);const r=n?.getTrackPublication(c);g(r)},1e3)),()=>{e!=0&&window.clearTimeout(e)}},[c,f,l,a]);const u=t.useCallback(()=>{T(window.innerHeight)},[]);if(t.useEffect(()=>{const e=b(u);return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[u]),!i||!a)return o.jsx("p",{children:" loading.... "});const S={participant:x,publication:a,source:c},[i,p]=l;return o.jsxs(C,{room:i,token:p.jwt,serverUrl:p.url,video:!1,audio:!1,children:[o.jsx(H,{muted:!0,autoPlay:!0,trackRef:S,height:v}),";"]})};h.render(o.jsx(t.StrictMode,{children:o.jsx(t.Suspense,{fallback:o.jsx("p",{children:"Connecting..."}),children:o.jsx(P,{})})}));
//# sourceMappingURL=popout-DUufa44L.js.map
